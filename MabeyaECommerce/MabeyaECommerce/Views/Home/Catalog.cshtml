@model Catalog
@{
    ViewData["Title"] = Model.Name;

    var products = Model.Products.Select(p => new ProductTileViewModel
    {
        Id = p.Id,
        Name = p.Name!,
        Price = p.Price,
        CategoryId = p.CategoryId,
        CategoryName = p.Category!.Name!
    });
}

<div class="container mt-3">

    <div class="row">

        <div class="col-12 col-md-3">

            <div class="card shadow-sm p-3">

                <h5 class="fw-bold mb-3">@Model.Name Filtreleri</h5>

                <div class="mb-3">
                    <label class="form-label fw-bold">Fiyat Aralığı</label>
                    <input type="number" id="minPrice" class="form-control mb-2" placeholder="Min">
                    <input type="number" id="maxPrice" class="form-control" placeholder="Max">
                </div>

                <div class="mb-3">
                    <label class="form-label fw-bold">Sıralama</label>
                    <select id="sort" class="form-select">
                        <option value="">Varsayılan</option>
                        <option value="new">En Yeni</option>
                        <option value="asc">Ucuzdan Pahalıya</option>
                        <option value="desc">Pahalıdan Ucuza</option>
                    </select>
                </div>

                <button class="btn btn-primary w-100 mt-2" onclick="applyCatalogFilters()">
                    Filtrele
                </button>

            </div>

        </div>

        <div class="col-12 col-md-9">

            <div id="productList">
                <partial name="_ProductListPartial" model="products" />
            </div>

        </div>

    </div>

</div>


@section Scripts{

    <script>
function applyCatalogFilters() {

    $.ajax({
        url: "/Home/FilterCatalogProducts",
        type: "GET",
        data: {
            catalogId: "@Model.Id",
            minPrice: $("#minPrice").val(),
            maxPrice: $("#maxPrice").val(),
            sort: $("#sort").val()
        },
        success: function (html) {
            $("#productList").html(html);
        }
    });

}

    </script>

}
